@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

@inject NavigationManager Navigation
@inject SignOutSessionStateManager SignOutManager

<div class="logo-box logo">
    <div class="d-none d-md-block">
    <img src="/images/logo_w_title.png" class="img-fluid" />
    </div>
</div>

<div class="@NavMenuCssClass" @onclick="ToggleNavMenu">
    <AuthorizeView>
    <Authorized>
        <div class="identity">
        Hello, @context.User.Identity.Name
        </div>
        <ul class="nav flex-column">
            <li class="nav-item">
                <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                    <span class="fas fa-home" aria-hidden="true"></span> Home
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link" href="itunes">
                    <span class="fas fa-apple-alt" aria-hidden="true"></span> iTunes
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link" href="releases">
                    <span class="fas fa-record-vinyl" aria-hidden="true"></span> Releases
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link" href="mixes">
                    <span class="fas fa-headphones" aria-hidden="true"></span> Mixes
                </NavLink>
            </li>
            <li class="nav-item">
                <NavLink class="nav-link" href="videos">
                    <span class="fas fa-camera" aria-hidden="true"></span> Videos
                </NavLink>
            </li>
            <li class="nav-item">
                <button class="nav-link btn btn-link" @onclick="BeginLogout">
                    <span class="fas fa-sign-out" aria-hidden="true"></span> Sign out
                </button>
            </li>
        </ul>
    </Authorized>
    <NotAuthorized>
        <ul class="nav flex-column">
            <li class="nav-item">
            <a href="authentication/login">
                <span class="fas fa-sign-in" aria-hidden="true"></span> Sign in
            </a>
            </li>
        </ul>
    </NotAuthorized>
</AuthorizeView>

    
</div>

@code {
    private bool collapseNavMenu = true;

    private string NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }

    private async Task BeginLogout(MouseEventArgs args)
    {
        await SignOutManager.SetSignOutState();
        Navigation.NavigateTo("authentication/logout");
    }
}

